# ğŸ”§ JBoss/WildFly ç’°å¢ƒè®Šæ•¸è¨­å®šç¸½è¦½

## ğŸ“Š å¿«é€Ÿå°æ¯”è¡¨

| è¨­å®šæ–¹å¼ | æª”æ¡ˆä½ç½® | è®€å–æ–¹å¼ | é©ç”¨å ´æ™¯ | å„ªå…ˆé †åº |
|---------|---------|---------|---------|---------|
| **standalone.conf** | `bin/standalone.conf` | `System.getProperty()` æˆ– `System.getenv()` | æœ¬åœ°éƒ¨ç½²ã€å‚³çµ±éƒ¨ç½² | â­â­â­â­â­ |
| **docker-compose.yml** | `docker-compose.yml` | `System.getenv()` | å®¹å™¨åŒ–éƒ¨ç½² | â­â­â­â­ |
| **standalone.xml (JNDI)** | `standalone/configuration/standalone.xml` | JNDI lookup | æ‡‰ç”¨ç¨‹å¼ç´šåˆ¥ | â­â­â­ |
| **web.xml** | `WEB-INF/web.xml` | JNDI lookup | Web æ‡‰ç”¨å°ˆå±¬ | â­â­ |
| **å±¬æ€§æª”æ¡ˆ** | `application.properties` | `Properties.load()` | ç¡¬ç·¨ç¢¼é…ç½® | â­ |

---

## ğŸ¯ Tomcat vs JBoss/WildFly å°æ¯”

| é …ç›® | Tomcat | JBoss/WildFly |
|------|--------|---------------|
| **ä¸»è¦é…ç½®æª”æ¡ˆ** | `META-INF/context.xml` | `bin/standalone.conf` |
| **Docker é…ç½®** | `docker-compose.yml` | `docker-compose.yml` |
| **ç’°å¢ƒè®Šæ•¸æ¨™ç±¤** | `<Environment>` | `export` æˆ– `-D` |
| **JNDI é…ç½®** | `<Resource>` | `<subsystem>...<bindings>` |
| **è®€å–æ–¹å¼** | JNDI lookup | `System.getenv()` æˆ– JNDI |

---

## ğŸ“ æœ¬å°ˆæ¡ˆæª”æ¡ˆçµæ§‹

```
jboss-demo/
â”œâ”€â”€ docker-compose.yml                    # âœ… ç›®å‰ä½¿ç”¨ï¼ˆå®¹å™¨éƒ¨ç½²ï¼‰
â”œâ”€â”€ wildfly-config/
â”‚   â”œâ”€â”€ standalone.conf                   # âœ… å‚³çµ±éƒ¨ç½²é…ç½®ï¼ˆLinux/Macï¼‰
â”‚   â”œâ”€â”€ standalone.conf.bat               # âœ… å‚³çµ±éƒ¨ç½²é…ç½®ï¼ˆWindowsï¼‰
â”‚   â””â”€â”€ standalone-custom.xml             # JNDI é…ç½®ç¯„ä¾‹
â”œâ”€â”€ src/main/
â”‚   â”œâ”€â”€ java/com/example/jboss/
â”‚   â”‚   â”œâ”€â”€ util/
â”‚   â”‚   â”‚   â””â”€â”€ ConfigUtil.java           # âœ… çµ±ä¸€è®€å–å·¥å…·
â”‚   â”‚   â””â”€â”€ rest/
â”‚   â”‚       â””â”€â”€ EnvironmentResource.java  # âœ… API ç«¯é»
â”‚   â””â”€â”€ webapp/WEB-INF/
â”‚       â”œâ”€â”€ jboss-web.xml                 # JBoss é…ç½®
â”‚       â”œâ”€â”€ beans.xml                     # CDI é…ç½®
â”‚       â””â”€â”€ web.xml                       # (å¯é¸) env-entry é…ç½®
â””â”€â”€ èªªæ˜æ–‡ä»¶/
    â”œâ”€â”€ STANDALONE_CONFèªªæ˜.md            # âœ… standalone.conf è©³ç´°èªªæ˜
    â”œâ”€â”€ ENV_CONFIG.md                     # âœ… å®Œæ•´ç’°å¢ƒè®Šæ•¸æŒ‡å—
    â””â”€â”€ ç’°å¢ƒè®Šæ•¸è¨­å®šèªªæ˜.md                 # âœ… å¿«é€ŸæŒ‡å—
```

---

## ğŸš€ ä½¿ç”¨å»ºè­°

### æƒ…å¢ƒ 1: å®¹å™¨åŒ–éƒ¨ç½²ï¼ˆDockerï¼‰

**æ¨è–¦**: ä½¿ç”¨ `docker-compose.yml`

```yaml
# docker-compose.yml
services:
  wildfly:
    environment:
      - APP_NAME=JBoss Demo Application
      - APP_VERSION=1.0.0
```

**å„ªé»**:
- âœ… ç°¡å–®ç›´æ¥
- âœ… ç¬¦åˆå®¹å™¨åŒ–æœ€ä½³å¯¦å‹™
- âœ… æ˜“æ–¼ CI/CD æ•´åˆ

### æƒ…å¢ƒ 2: å‚³çµ±éƒ¨ç½²ï¼ˆæœ¬åœ°ä¼ºæœå™¨ï¼‰

**æ¨è–¦**: ä½¿ç”¨ `bin/standalone.conf`

```bash
# standalone.conf
export APP_NAME="JBoss Demo Application"
export APP_VERSION="1.0.0"

# æˆ–ä½¿ç”¨ System Properties
JAVA_OPTS="$JAVA_OPTS -DAPP_NAME='JBoss Demo Application'"
```

**å„ªé»**:
- âœ… ç¬¦åˆ JBoss/WildFly æ¨™æº–åšæ³•
- âœ… å¯è¨­å®šå®Œæ•´ JVM åƒæ•¸
- âœ… é›†ä¸­ç®¡ç†ä¼ºæœå™¨é…ç½®

### æƒ…å¢ƒ 3: æ··åˆéƒ¨ç½²

**æ¨è–¦**: `standalone.conf` + `docker-compose.yml`

```yaml
# docker-compose.yml
volumes:
  - ./wildfly-config/standalone.conf:/opt/jboss/wildfly/bin/standalone.conf
environment:
  - APP_ENVIRONMENT=production  # è¦†å¯«ç‰¹å®šç’°å¢ƒçš„å€¼
```

**å„ªé»**:
- âœ… standalone.conf è¨­å®šé è¨­å€¼å’Œ JVM åƒæ•¸
- âœ… docker-compose.yml è¦†å¯«ç’°å¢ƒç‰¹å®šå€¼
- âœ… å½ˆæ€§æœ€é«˜

---

## ğŸ“– è®€å–ç’°å¢ƒè®Šæ•¸çš„æ–¹å¼

### æ–¹æ³• 1: ç›´æ¥è®€å–ç³»çµ±ç’°å¢ƒè®Šæ•¸

```java
String appName = System.getenv("APP_NAME");
```

**é©ç”¨**: docker-compose.ymlã€standalone.conf (export)

### æ–¹æ³• 2: è®€å– System Properties

```java
String appName = System.getProperty("APP_NAME");
```

**é©ç”¨**: standalone.conf (-D åƒæ•¸)

### æ–¹æ³• 3: JNDI Lookup

```java
InitialContext ctx = new InitialContext();
String appName = (String) ctx.lookup("java:global/env/APP_NAME");
```

**é©ç”¨**: standalone.xml (JNDI bindings)ã€web.xml (env-entry)

### æ–¹æ³• 4: ä½¿ç”¨ ConfigUtilï¼ˆæ¨è–¦ï¼‰

```java
import com.example.jboss.util.ConfigUtil;

// æ™ºèƒ½è®€å–ï¼ˆè‡ªå‹•å˜—è©¦å¤šç¨®æ–¹å¼ï¼‰
String appName = ConfigUtil.getConfig("APP_NAME", "é è¨­å€¼");
```

**å„ªé»**:
- âœ… è‡ªå‹•å˜—è©¦: JNDI â†’ ç’°å¢ƒè®Šæ•¸ â†’ System Properties â†’ é è¨­å€¼
- âœ… çµ±ä¸€ä»‹é¢
- âœ… å®¹éŒ¯èƒ½åŠ›å¼·

---

## ğŸ” å¦‚ä½•é¸æ“‡è¨­å®šæ–¹å¼ï¼Ÿ

### æ ¹æ“šéƒ¨ç½²æ–¹å¼é¸æ“‡

```
æ˜¯å¦ä½¿ç”¨ Dockerï¼Ÿ
â”‚
â”œâ”€ æ˜¯ â†’ ä½¿ç”¨ docker-compose.yml
â”‚      éœ€è¦ JVM èª¿æ ¡ï¼Ÿ
â”‚      â”‚
â”‚      â”œâ”€ æ˜¯ â†’ åŒæ™‚ä½¿ç”¨ standalone.conf
â”‚      â””â”€ å¦ â†’ åªç”¨ docker-compose.yml
â”‚
â””â”€ å¦ â†’ ä½¿ç”¨ standalone.conf
       éœ€è¦æ‡‰ç”¨ç¨‹å¼ç´šåˆ¥é…ç½®ï¼Ÿ
       â”‚
       â”œâ”€ æ˜¯ â†’ åŒæ™‚ä½¿ç”¨ standalone.xml (JNDI)
       â””â”€ å¦ â†’ åªç”¨ standalone.conf
```

### æ ¹æ“šè®Šæ•¸é¡å‹é¸æ“‡

| è®Šæ•¸é¡å‹ | æ¨è–¦æ–¹å¼ | ç†ç”± |
|---------|---------|------|
| **æ‡‰ç”¨ç¨‹å¼é…ç½®** | docker-compose.yml æˆ– standalone.conf | ç°¡å–®ç›´æ¥ |
| **æ•æ„Ÿè³‡è¨Š** | Docker Secrets æˆ– .env æª”æ¡ˆ | å®‰å…¨æ€§ |
| **JVM åƒæ•¸** | standalone.conf | å”¯ä¸€é¸æ“‡ |
| **æ‡‰ç”¨ç¨‹å¼å…±äº«è³‡æº** | standalone.xml (JNDI) | è·¨æ‡‰ç”¨ç¨‹å¼ |
| **Web æ‡‰ç”¨å°ˆå±¬** | web.xml | æ‡‰ç”¨ç¨‹å¼éš”é›¢ |

---

## ğŸ“š è©³ç´°æ–‡ä»¶ç´¢å¼•

| æ–‡ä»¶ | å…§å®¹ | é©åˆè®€è€… |
|------|------|---------|
| [ç’°å¢ƒè®Šæ•¸è¨­å®šèªªæ˜.md](ç’°å¢ƒè®Šæ•¸è¨­å®šèªªæ˜.md) | å¿«é€Ÿå…¥é–€æŒ‡å— | åˆå­¸è€… |
| [STANDALONE_CONFèªªæ˜.md](STANDALONE_CONFèªªæ˜.md) | standalone.conf å®Œæ•´èªªæ˜ | å‚³çµ±éƒ¨ç½² |
| [ENV_CONFIG.md](ENV_CONFIG.md) | æ‰€æœ‰è¨­å®šæ–¹å¼çš„å®Œæ•´æŒ‡å— | é€²éšä½¿ç”¨è€… |
| [README.md](README.md) | å°ˆæ¡ˆç¸½è¦½ | æ‰€æœ‰äºº |
| [QUICK_START.md](QUICK_START.md) | å¿«é€Ÿé–‹å§‹ï¼ˆä¸­è‹±æ–‡ï¼‰ | åˆå­¸è€… |

---

## âœ… æœ€ä½³å¯¦å‹™ç¸½çµ

### é–‹ç™¼ç’°å¢ƒ âœ¨
```yaml
# docker-compose.yml
environment:
  - APP_NAME=JBoss Demo
  - DEBUG=true
```

### æ¸¬è©¦ç’°å¢ƒ ğŸ§ª
```bash
# standalone.conf
export APP_ENVIRONMENT="testing"
export DATABASE_URL="jdbc:postgresql://test-db:5432/testdb"
```

### ç”Ÿç”¢ç’°å¢ƒ ğŸš€
```yaml
# docker-compose.yml
env_file:
  - .env.production  # æ•æ„Ÿè³‡è¨Š
volumes:
  - ./wildfly-config/standalone.conf:/opt/jboss/wildfly/bin/standalone.conf
```

---

## ğŸ’¡ æ‚¨çš„å•é¡Œè§£ç­”

### Q: åœ¨ Tomcat ä¸­æˆ‘ç”¨ `META-INF/context.xml`ï¼Œåœ¨ JBoss ä¸­ç”¨ä»€éº¼ï¼Ÿ

**A**: æœ‰å…©ç¨®ä¸»è¦æ–¹å¼ï¼š

1. **å®¹å™¨åŒ–éƒ¨ç½²**: `docker-compose.yml`ï¼ˆé¡ä¼¼ Docker çš„ Tomcat è¨­å®šï¼‰
2. **å‚³çµ±éƒ¨ç½²**: `bin/standalone.conf`ï¼ˆJBoss æ¨™æº–æ–¹å¼ï¼‰

### Q: å…¶ä»–äººèªª jboss çš„ç’°å¢ƒè®Šæ•¸æœƒå¾ `bin/standalone.conf` è®€å–ï¼Ÿ

**A**: **å®Œå…¨æ­£ç¢º**ï¼`standalone.conf` æ˜¯ JBoss/WildFly çš„æ¨™æº–é…ç½®æª”æ¡ˆï¼Œç”¨æ–¼ï¼š
- âœ… è¨­å®šç’°å¢ƒè®Šæ•¸
- âœ… è¨­å®š JVM åƒæ•¸ï¼ˆè¨˜æ†¶é«”ã€GC ç­‰ï¼‰
- âœ… è¨­å®š System Properties

åœ¨å®¹å™¨åŒ–éƒ¨ç½²ä¸­ï¼Œ`docker-compose.yml` æ›´å¸¸ç”¨ï¼Œä½† `standalone.conf` ä»ç„¶æ˜¯å‚³çµ±éƒ¨ç½²çš„é¦–é¸ã€‚

### Q: æˆ‘æ‡‰è©²ç”¨å“ªä¸€ç¨®ï¼Ÿ

**A**:
- ğŸ³ **ä½¿ç”¨ Docker**: `docker-compose.yml`ï¼ˆæ›´ç°¡å–®ï¼‰
- ğŸ–¥ï¸ **æœ¬åœ°éƒ¨ç½²**: `standalone.conf`ï¼ˆæ›´æ¨™æº–ï¼‰
- ğŸ”„ **å…©è€…ä½µç”¨**: æœ€ä½³å½ˆæ€§ï¼ˆæ¨è–¦ï¼‰

---

## ğŸ‰ çµè«–

æœ¬å°ˆæ¡ˆæä¾›äº†**å®Œæ•´çš„ç’°å¢ƒè®Šæ•¸è¨­å®šæ–¹æ¡ˆ**ï¼š

1. âœ… **docker-compose.yml** - å®¹å™¨åŒ–éƒ¨ç½²ï¼ˆç›®å‰ä½¿ç”¨ï¼‰
2. âœ… **standalone.conf** - å‚³çµ± JBoss éƒ¨ç½²ï¼ˆå·²å»ºç«‹ç¯„ä¾‹ï¼‰
3. âœ… **ConfigUtil.java** - çµ±ä¸€è®€å–ä»‹é¢ï¼ˆæ™ºèƒ½é™ç´šï¼‰
4. âœ… **å®Œæ•´æ–‡ä»¶** - ä¸­è‹±æ–‡èªªæ˜

æ‚¨å¯ä»¥æ ¹æ“šå¯¦éš›éœ€æ±‚é¸æ“‡æœ€é©åˆçš„æ–¹å¼ï¼ğŸš€
