# ğŸ”§ JBoss/WildFly ç’°å¢ƒè®Šæ•¸è¨­å®šèªªæ˜

## ğŸ“ å¿«é€Ÿå›ç­”æ‚¨çš„å•é¡Œ

### Tomcat vs JBoss ç’°å¢ƒè®Šæ•¸è¨­å®šä½ç½®å°æ¯”

| é …ç›® | Tomcat | JBoss/WildFly |
|------|--------|---------------|
| **é…ç½®æª”æ¡ˆ** | `webapp/META-INF/context.xml` | **`docker-compose.yml`** (æ¨è–¦) |
| **é…ç½®ç¯„ä¾‹** | `<Environment name="..." value="..."/>` | `environment: - APP_NAME=...` |
| **è®€å–æ–¹å¼** | JNDI lookup | `System.getenv()` |

### ğŸ¯ æœ¬å°ˆæ¡ˆç›®å‰çš„è¨­å®šæ–¹å¼

**è¨­å®šä½ç½®**: [`docker-compose.yml`](docker-compose.yml) çš„ç¬¬ 14-18 è¡Œ

```yaml
environment:
  - APP_NAME=JBoss Demo Application
  - APP_VERSION=1.0.0
  - APP_ENVIRONMENT=production
  - DATABASE_URL=jdbc:postgresql://localhost:5432/demodb
  - API_KEY=demo-api-key-12345
```

---

## ğŸ“‚ æª”æ¡ˆçµæ§‹å°æ‡‰

```
Tomcat å°ˆæ¡ˆ:
  â””â”€â”€ webapp/
      â””â”€â”€ META-INF/
          â””â”€â”€ context.xml  â† åœ¨é€™è£¡è¨­å®šç’°å¢ƒè®Šæ•¸

JBoss/WildFly å°ˆæ¡ˆ:
  â”œâ”€â”€ docker-compose.yml   â† âœ… åœ¨é€™è£¡è¨­å®šç’°å¢ƒè®Šæ•¸ (æ¨è–¦)
  â”œâ”€â”€ src/main/webapp/WEB-INF/
  â”‚   â”œâ”€â”€ jboss-web.xml    â† JBoss å°ˆç”¨é…ç½®
  â”‚   â””â”€â”€ web.xml          â† ä¹Ÿå¯ä»¥åœ¨é€™è£¡è¨­å®š (å‚³çµ±æ–¹å¼)
  â””â”€â”€ wildfly-config/
      â””â”€â”€ standalone-custom.xml  â† JNDI è¨­å®šç¯„ä¾‹
```

---

## ğŸš€ å¦‚ä½•ä¿®æ”¹ç’°å¢ƒè®Šæ•¸

### æ–¹æ³• 1: ä¿®æ”¹ docker-compose.yml (æ¨è–¦)

1. **ç·¨è¼¯æª”æ¡ˆ**:
```bash
vim docker-compose.yml
```

2. **ä¿®æ”¹ environment å€æ®µ**:
```yaml
environment:
  - APP_NAME=æˆ‘çš„æ‡‰ç”¨ç¨‹å¼      # ä¿®æ”¹ç¾æœ‰è®Šæ•¸
  - NEW_VARIABLE=æ–°çš„å€¼        # æ–°å¢è®Šæ•¸
  - DATABASE_URL=jdbc:mysql://db:3306/mydb
```

3. **é‡æ–°éƒ¨ç½²**:
```bash
docker-compose down
docker-compose up -d
```

4. **é©—è­‰**:
```bash
curl http://localhost:8080/jboss-demo/api/environment/custom
```

### æ–¹æ³• 2: ä½¿ç”¨ .env æª”æ¡ˆ (æ›´å®‰å…¨)

1. **å»ºç«‹ .env æª”æ¡ˆ**:
```bash
# .env
APP_NAME=æˆ‘çš„æ‡‰ç”¨
APP_VERSION=2.0.0
DATABASE_PASSWORD=secret123
API_KEY=your-secret-key
```

2. **ä¿®æ”¹ docker-compose.yml**:
```yaml
services:
  wildfly:
    env_file:
      - .env
```

3. **è¨˜å¾—å°‡ .env åŠ å…¥ .gitignore**:
```bash
echo ".env" >> .gitignore
```

---

## ğŸ“¡ æ–°å¢çš„ API ç«¯é»

æˆ‘å·²ç¶“æ–°å¢äº†å…©å€‹ç«¯é»ä¾†å±•ç¤ºä¸åŒçš„è®€å–æ–¹å¼ï¼š

### 1. Smart Config Reading (æ™ºèƒ½è®€å–)
```bash
curl http://localhost:8080/jboss-demo/api/environment/smart
```

æœƒä¾åºå˜—è©¦ï¼šJNDI â†’ ç³»çµ±ç’°å¢ƒè®Šæ•¸ â†’ System Properties â†’ é è¨­å€¼

### 2. Methods Comparison (æ–¹æ³•å°æ¯”)
```bash
curl http://localhost:8080/jboss-demo/api/environment/methods
```

å±•ç¤ºåŒä¸€å€‹ç’°å¢ƒè®Šæ•¸ç”¨ä¸åŒæ–¹æ³•è®€å–çš„çµæœ

---

## ğŸ”‘ é‡é»æ•´ç†

### âœ… æ¨è–¦åšæ³•

1. **é–‹ç™¼ç’°å¢ƒ**: ä½¿ç”¨ `docker-compose.yml` è¨­å®šç’°å¢ƒè®Šæ•¸
2. **ç”Ÿç”¢ç’°å¢ƒ**: ä½¿ç”¨ `.env` æª”æ¡ˆ + Docker Secrets
3. **è®€å–æ–¹å¼**: ä½¿ç”¨ `ConfigUtil.getConfig()` æ™ºèƒ½è®€å–

### âŒ ä¸å»ºè­°åšæ³•

1. âŒ å°‡æ•æ„Ÿè³‡è¨Šå¯«æ­»åœ¨ç¨‹å¼ç¢¼ä¸­
2. âŒ å°‡å¯†ç¢¼ã€API Key æäº¤åˆ° Git
3. âŒ åœ¨ `standalone.xml` ä¸­ç›´æ¥å¯«å…¥å¯†ç¢¼

---

## ğŸ“ å¯¦ç”¨å·¥å…·é¡åˆ¥

æˆ‘å·²ç¶“å»ºç«‹äº† [`ConfigUtil.java`](src/main/java/com/example/jboss/util/ConfigUtil.java) å·¥å…·é¡åˆ¥ï¼š

```java
import com.example.jboss.util.ConfigUtil;

// æ™ºèƒ½è®€å– (æ¨è–¦)
String appName = ConfigUtil.getConfig("APP_NAME", "é è¨­å€¼");

// æŒ‡å®šè®€å–æ–¹å¼
String version = ConfigUtil.getFromSystemEnv("APP_VERSION");
String dbUrl = ConfigUtil.getFromJNDI("java:global/env/DATABASE_URL");
```

---

## ğŸ” æ›´å¤šè³‡è¨Š

è©³ç´°èªªæ˜è«‹åƒè€ƒï¼š
- [`ENV_CONFIG.md`](ENV_CONFIG.md) - å®Œæ•´çš„ç’°å¢ƒè®Šæ•¸è¨­å®šæŒ‡å—
- [`README.md`](README.md) - å°ˆæ¡ˆèªªæ˜æ–‡ä»¶
- [`QUICK_START.md`](QUICK_START.md) - å¿«é€Ÿé–‹å§‹æŒ‡å—

---

## ğŸ’¡ ç¸½çµ

**æœ€ç›´æ¥çš„ç­”æ¡ˆ**:
- Tomcat çš„ `META-INF/context.xml` = JBoss çš„ **`docker-compose.yml`**
- åœ¨ `docker-compose.yml` çš„ `environment:` å€æ®µè¨­å®šç’°å¢ƒè®Šæ•¸
- ä½¿ç”¨ `System.getenv("è®Šæ•¸åç¨±")` è®€å–

å°±é€™éº¼ç°¡å–®ï¼ ğŸ‰
